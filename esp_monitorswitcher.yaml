esphome:
  name: monitorswitcher

external_components:
  - source:
      type: local
      path: components

esp32:
  board: mhetesp32minikit
  framework:
    type: arduino
    
# Enable logging
logger:

# Enable Home Assistant API
api:
  password: !secret api_password

ota:
  password: !secret ota_password

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  power_save_mode: NONE

  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: MonitorSwitcher
    password: !secret ap_password

i2c:
  scl: SCL
  sda: SDA
  scan: False
  frequency: 50khz

select:
  - platform: "hdmiddc"
    name: "HDMI Input Select"
    id: hdmi_input_select
    options: 
      0x01: DISPLAYPORT
      0x03: HDMI1
      0x11: HDMI2

sensor:
  - platform: adc
    id: photocell_measurement
    pin: A0
    name: "Photocell 0"
    device_class: illuminance
    update_interval: 500ms
    unit_of_measurement: lx
    filters:
      - lambda: |-
          return (x / 10000.0) * 2000000.0;
    on_value_range: 
      - above: 150
        then:
          - select.set: 
              id: hdmi_input_select
              option: "DISPLAYPORT"
          - text_sensor.template.publish: 
              id: usb_input_sensor
              state: "1"              
      - below: 150
        then:
          - select.set:
              id: hdmi_input_select
              option: "HDMI2"
          - text_sensor.template.publish: 
              id: usb_input_sensor
              state: "2"

text_sensor:
  - platform: template
    name: "Active USB Input"
    id: usb_input_sensor

      